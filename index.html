<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>67 è¨˜æ†¶é«”ä¿è¡›æˆ°</title>
    <style>
        body {
            margin: 0;
            padding: 0;
            background-color: #000;
            font-family: 'Consolas', 'Arial', sans-serif;
            overflow: hidden; 
            color: white;
            user-select: none;
        }

        /* --- 1. èª˜é¤Œå±¤ (é–‹å§‹ç•«é¢) --- */
        #start-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #000;
            z-index: 20000;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            cursor: pointer;
        }

        .big-red-btn {
            width: 180px;
            height: 180px;
            background: radial-gradient(circle at 30% 30%, #ff0000, #550000);
            border-radius: 50%;
            border: 5px solid #330000;
            box-shadow: 0 0 40px #ff0000;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 24px;
            font-weight: bold;
            text-align: center;
            color: white;
            animation: pulse 2s infinite;
            text-shadow: 2px 2px 0px black;
        }
        
        .best-score {
            margin-top: 20px;
            color: #ffff00;
            font-size: 18px;
            border: 1px solid #ffff00;
            padding: 5px 15px;
            border-radius: 5px;
        }

        @keyframes pulse {
            0% { transform: scale(1); box-shadow: 0 0 20px #ff0000; }
            50% { transform: scale(1.05); box-shadow: 0 0 50px #ff0000; }
            100% { transform: scale(1); box-shadow: 0 0 20px #ff0000; }
        }

        /* --- 2. éŠæˆ²ä»‹é¢ (è² è¼‰æ¢) --- */
        #game-ui {
            display: none; /* åˆå§‹éš±è— */
        }

        #ram-bar-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 30px;
            background: #222;
            z-index: 15000;
            border-bottom: 2px solid #555;
            display: flex;
            align-items: center;
        }

        #ram-label {
            width: 120px;
            padding-left: 10px;
            font-size: 14px;
            color: #fff;
            font-weight: bold;
        }

        #ram-progress {
            flex-grow: 1;
            height: 100%;
            background: #333;
            position: relative;
        }

        #ram-fill {
            width: 0%;
            height: 100%;
            background: linear-gradient(90deg, #0f0, #ff0, #f00);
            transition: width 0.2s;
        }
        
        #ram-percent {
            position: absolute;
            right: 10px;
            top: 5px;
            color: white;
            font-weight: bold;
            font-size: 14px;
            mix-blend-mode: difference;
        }

        /* è¨ˆæ™‚å™¨ (ç§»åˆ°åº•éƒ¨ï¼Œé¿å…æ“‹ä½) */
        #timer-display {
            position: fixed;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            font-size: 40px;
            font-weight: bold;
            color: white;
            text-shadow: 0 0 10px blue;
            z-index: 10000;
            pointer-events: none; /* è®“æ»‘é¼ å¯ä»¥ç©¿é€å®ƒé»æ“Šå¾Œé¢çš„æ±è¥¿ */
        }

        /* --- 3. è—å±ç•¶æ©Ÿç•«é¢ (Game Over) --- */
        #bsod-screen {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            background: #0000aa; /* ç¶“å…¸è— */
            color: white;
            z-index: 99999;
            padding: 50px;
            box-sizing: border-box;
            font-family: 'Courier New', Courier, monospace;
        }

        /* --- 4. å»£å‘Šè¦–çª— --- */
        .ad-popup {
            position: absolute;
            width: 260px;
            background: #e0e0e0; 
            border: 2px solid #000;
            box-shadow: 5px 5px 0px rgba(0,0,0,0.5);
            z-index: 9999;
            color: #000;
            display: flex;
            flex-direction: column;
            user-select: none;
            animation: popIn 0.2s;
        }

        .ad-header {
            background: #000080; /* æ·±è—è‰²æ¨™é¡Œåˆ— */
            color: #fff;
            padding: 4px 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 14px;
            font-weight: bold;
        }

        .close-btn {
            width: 18px;
            height: 18px;
            background: #ccc;
            color: black;
            text-align: center;
            line-height: 16px;
            border: 1px solid white;
            border-right-color: gray;
            border-bottom-color: gray;
            cursor: pointer;
            font-size: 12px;
        }
        
        .close-btn:active { border: 1px solid gray; }

        .ad-body { padding: 10px; text-align: center; }

        .ad-image {
            width: 100%;
            height: 100px;
            object-fit: cover;
            border: 1px inset #fff;
            margin-bottom: 5px;
            background: #000;
        }

        .btn-fake {
            background: #ddd;
            border: 1px outset #fff;
            padding: 5px 10px;
            cursor: pointer;
            margin-top: 5px;
            font-size: 12px;
        }
        .btn-fake:active { border-style: inset; }

        /* èƒŒæ™¯ç‰† */
        #gif-container {
            position: absolute;
            top: 0; left: 0; width: 100%; height: 100%;
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
            grid-auto-rows: 150px;
            gap: 0;
            z-index: 1;
            opacity: 0.3;
            pointer-events: none;
        }
        .gif-item { width: 100%; height: 100%; object-fit: cover; }

        @keyframes popIn { from { transform: scale(0); } to { transform: scale(1); } }
    </style>
</head>
<body>

    <div id="start-screen" onclick="startGame()">
        <div class="big-red-btn">START<br>67</div>
        <div style="margin-top:20px; text-align:center;">
            ä»»å‹™ï¼šå¿«é€Ÿé—œé–‰è¦–çª—ï¼Œåˆ¥è®“è¨˜æ†¶é«”çˆ†æ»¿ (100%)<br>
            <span style="font-size:12px; color:#888;">(é»æ“Šç´…è‰²æŒ‰éˆ•é–‹å§‹)</span>
        </div>
        <div id="best-score-display" class="best-score" style="display:none;">
            ğŸ† æœ€é«˜ç´€éŒ„: 0.00 ç§’
        </div>
    </div>

    <div id="game-ui">
        <div id="ram-bar-container">
            <div id="ram-label">MEMORY (RAM)</div>
            <div id="ram-progress">
                <div id="ram-fill"></div>
                <div id="ram-percent">0%</div>
            </div>
        </div>
        <div id="timer-display">0.00</div>
    </div>

    <div id="gif-container"></div>

    <div id="bsod-screen" onclick="location.reload()">
        <h1>:(</h1>
        <h2>Your device ran into a problem and needs to restart.</h2>
        <br>
        <p>Stop code: MEMORY_MANAGEMENT_67_ERROR</p>
        <p>Your Score: <span id="final-score">0.00</span>s</p>
        <br><br>
        <div style="background:white; color:#0000aa; padding:5px; display:inline-block; font-weight:bold; cursor:pointer;">
            [ é»æ“Šç•«é¢é‡æ–°æŒ‘æˆ° ]
        </div>
    </div>

    <script>
        // è¨­å®šå°æµé€£çµ
        const moneyLink = "https://www.google.com"; // æ›æˆä½ çš„

        const userGifIds = [
            "x4sYb64AngRI9QznOA", "JiN5WlLgVpzR0807By", "ia0sMsvTBUQYb59SjK",
            "6lhWhkfSjPSA8actTr", "F75jjW9WGedu6Dfaye", "L4wjp6O1q3idwlu19D",
            "HXCCRHD0oUCl0JW77j", "esdY8MsQaI8CSBZN6L", "pFeq0rEzfj0PEBcEbx",
            "xWtBqXyFsv1BrS5rYC", "NyLL9u2i14DB5PFF8M", "R7Ln4BsstArSkfGcgq"
        ];
        const getGifUrl = (id) => `https://media.giphy.com/media/${id}/giphy.gif`;

        // ---------------- éŠæˆ²è®Šæ•¸ ----------------
        let gameActive = false;
        let startTime = 0;
        let memoryUsage = 0; // 0 ~ 100
        let currentInterval = 2000;
        let timerLoop;
        let spawnLoop;

        // ---------------- 0. åˆå§‹åŒ–èˆ‡è®€å–ç´€éŒ„ ----------------
        window.onload = function() {
            buildGifWall();
            // è®€å–æœ€é«˜åˆ†
            const best = localStorage.getItem('bestTime_67');
            if(best) {
                const badge = document.getElementById('best-score-display');
                badge.style.display = 'block';
                badge.innerText = `ğŸ† æœ€é«˜ç´€éŒ„: ${best} ç§’`;
            }
        };

        // ---------------- 1. é–‹å§‹éŠæˆ² ----------------
        function startGame() {
            if(gameActive) return;
            gameActive = true;

            // UI åˆ‡æ›
            document.getElementById('start-screen').style.display = 'none';
            document.getElementById('game-ui').style.display = 'block';

            // å•Ÿå‹•è¨ˆæ™‚
            startTime = Date.now();
            timerLoop = setInterval(updateTimer, 50);

            // å•Ÿå‹•å»£å‘Šå¾ªç’°
            spawnAdLoop();
        }

        // ---------------- 2. æ ¸å¿ƒè¿´åœˆï¼šç”Ÿæˆå»£å‘Š ----------------
        function spawnAdLoop() {
            if(!gameActive) return;

            spawnAd();

            // åŠ é€Ÿæ©Ÿåˆ¶ (è¶Šå¾Œé¢è¶Šå¿«)
            currentInterval = Math.max(300, currentInterval * 0.95); 
            
            spawnLoop = setTimeout(spawnAdLoop, currentInterval);
        }

        // ---------------- 3. ç”Ÿæˆå–®ä¸€å»£å‘Š ----------------
        function spawnAd() {
            if(!gameActive) return;

            // å¢åŠ è¨˜æ†¶é«”è² è¼‰ (æ‡²ç½°)
            increaseMemory(10); // æ¯å€‹å»£å‘Šå¢åŠ  10%

            const ad = document.createElement('div');
            ad.className = 'ad-popup';
            
            // éš¨æ©Ÿä½ç½® (é¿é–‹é ‚éƒ¨ 30px çš„ Ram Bar)
            const maxX = window.innerWidth - 280;
            const maxY = window.innerHeight - 200; // ç•™é»ç©ºé–“çµ¦åº•éƒ¨è¨ˆæ™‚å™¨
            const randomX = Math.max(0, Math.floor(Math.random() * maxX));
            const randomY = Math.max(40, Math.floor(Math.random() * maxY)); // Y å¾ 40 é–‹å§‹
            
            ad.style.left = randomX + 'px';
            ad.style.top = randomY + 'px';

            const randomGif = userGifIds[Math.floor(Math.random() * userGifIds.length)];

            ad.innerHTML = `
                <div class="ad-header">
                    <span>System Error</span>
                    <div class="close-btn" onclick="killAd(this)">X</div>
                </div>
                <div class="ad-body">
                    <img src="${getGifUrl(randomGif)}" class="ad-image">
                    <div>Memory leaking...</div>
                    <button class="btn-fake" onclick="window.open('${moneyLink}', '_blank')">Fix Now</button>
                </div>
            `;
            document.body.appendChild(ad);
        }

        // ---------------- 4. é—œé–‰å»£å‘Š (ç©å®¶æ“ä½œ) ----------------
        window.killAd = function(btn) {
            if(!gameActive) return;
            const popup = btn.closest('.ad-popup');
            if(popup) {
                popup.remove();
                // æ¸›å°‘è¨˜æ†¶é«”è² è¼‰ (çå‹µ)
                increaseMemory(-10); 
            }
        }

        // ---------------- 5. è¨˜æ†¶é«”æ§åˆ¶ç³»çµ± ----------------
        function increaseMemory(amount) {
            memoryUsage += amount;
            if(memoryUsage < 0) memoryUsage = 0;
            
            // æ›´æ–° UI
            const fill = document.getElementById('ram-fill');
            const percent = document.getElementById('ram-percent');
            fill.style.width = memoryUsage + '%';
            percent.innerText = memoryUsage + '%';

            // æª¢æŸ¥æ˜¯å¦çˆ†è¡¨
            if(memoryUsage >= 100) {
                gameOver();
            }
        }

        // ---------------- 6. æ›´æ–°æ™‚é–“ ----------------
        function updateTimer() {
            const now = Date.now();
            const diff = (now - startTime) / 1000;
            document.getElementById('timer-display').innerText = diff.toFixed(2);
        }

        // ---------------- 7. éŠæˆ²çµæŸ (BSOD) ----------------
        function gameOver() {
            gameActive = false;
            clearInterval(timerLoop);
            clearTimeout(spawnLoop);

            const finalTime = ((Date.now() - startTime) / 1000).toFixed(2);

            // å„²å­˜ç´€éŒ„
            const currentBest = parseFloat(localStorage.getItem('bestTime_67') || 0);
            if(parseFloat(finalTime) > currentBest) {
                localStorage.setItem('bestTime_67', finalTime);
            }

            // é¡¯ç¤ºè—å±
            const bsod = document.getElementById('bsod-screen');
            document.getElementById('final-score').innerText = finalTime;
            bsod.style.display = 'block';
        }

        // Helper
        function buildGifWall() {
            const container = document.getElementById('gif-container');
            let fullList = [];
            for(let i=0; i<8; i++) fullList = fullList.concat(userGifIds);
            fullList.sort(() => Math.random() - 0.5);
            fullList.forEach(id => {
                const img = document.createElement('img');
                img.src = getGifUrl(id);
                img.className = 'gif-item';
                container.appendChild(img);
            });
        }
    </script>
</body>
</html>
